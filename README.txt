# Version 1.0
# Matthew Cserhati
# June 10, 2019

This R script takes a similarity matrix file produced by any kind of algorith. What it does is it estimates the number of clusters within the data based on the k-means clustering algorithm. It produces statistics and lists the names of the species per cluster/baramin. It also generates several figures which describe the baramins predicted b the k-means algorithm.

You can run the script in this manner: 

Rscript kmeansClustering.R <similarity matrix> <k1> <k2> <k*> <cut>

i.e.

Rscript kmeansClustering.R octopus_ids2.txt 1 12 7 0.8

-similarity matrix: a square matrix, which contains similarity values for all possible species pairs, this is generated by an algorithm in a prior step
-k1: the miniumm number of predicted clusters
-k2: the maximum number of predicted clusters
-k*: if not zero, then this k-value overrides the optimal k-value
-cut: the cut-off calue needed for generating the Cytoscape figures

Output:
-beeswarm.jpg: beeswarm plot of the inputted similarity values
-BTplot.jpg: a plot of the betweenness squares/total squares for all k values between k1 and k2
-ecdf.jpg: an ECDF plot of similarity values in the matrix
-heatmap.jpg: heatmap of the similarity values showing clustering of the species
-matrix.attr: attribute file for Cytoscape
-clusters.txt: a list of species and the clusters that belong to it
-stats.txt: statistics for each cluster with over three species
-cluster(i).txt: this file contains a cladistic tree of the species found in cluster (baramin) i
